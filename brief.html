<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Synapse Studio | Protocol Initialization</title>
    
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600&family=JetBrains+Mono:wght@400;700&family=Rajdhani:wght@500;600;700&display=swap" rel="stylesheet">
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Icons (Lucide) -->
    <script src="https://unpkg.com/lucide@latest"></script>

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        cyber: {
                            black: '#050505',
                            dark: '#0a0a0a',
                            panel: '#111111',
                            green: '#00ff9d',
                            greenDim: 'rgba(0, 255, 157, 0.1)',
                            text: '#e0e0e0',
                            gray: '#888888'
                        }
                    },
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                        tech: ['JetBrains Mono', 'monospace'],
                        display: ['Rajdhani', 'sans-serif'],
                    },
                    backgroundImage: {
                        'grid-pattern': "linear-gradient(to right, #1a1a1a 1px, transparent 1px), linear-gradient(to bottom, #1a1a1a 1px, transparent 1px)",
                    },
                    animation: {
                        'spin-slow': 'spin 10s linear infinite',
                    }
                }
            }
        }
    </script>

    <style>
        body {
            background-color: #050505;
            color: #e0e0e0;
            overflow-x: hidden;
        }

        /* Scanline Effect */
        .scanline {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100vh;
            background: linear-gradient(to bottom, rgba(255,255,255,0), rgba(255,255,255,0) 50%, rgba(0,0,0,0.1) 50%, rgba(0,0,0,0.1));
            background-size: 100% 4px;
            pointer-events: none;
            z-index: 9999;
            opacity: 0.3;
        }

        /* Neon Focus */
        .input-cyber:focus {
            box-shadow: 0 0 15px rgba(0, 255, 157, 0.3);
            border-color: #00ff9d;
        }

        /* Animations */
        .step-enter { animation: fadeInRight 0.5s ease-out forwards; }
        @keyframes fadeInRight {
            from { opacity: 0; transform: translateX(20px); }
            to { opacity: 1; transform: translateX(0); }
        }

        .progress-bar-fill {
            box-shadow: 0 0 10px #00ff9d;
            transition: width 0.5s cubic-bezier(0.4, 0, 0.2, 1);
        }
    </style>
</head>
<body class="font-sans antialiased min-h-screen flex flex-col relative selection:bg-cyber-green selection:text-black">

    <div class="scanline"></div>
    <div class="fixed inset-0 bg-grid-pattern opacity-20 -z-10 pointer-events-none"></div>

    <!-- Header -->
    <header class="w-full py-6 px-8 border-b border-white/10 bg-cyber-black/90 backdrop-blur-md z-50">
        <div class="max-w-4xl mx-auto flex items-center justify-between">
            <a href="index-4.html" class="flex items-center gap-2 group cursor-pointer">
                <i data-lucide="cpu" class="text-cyber-green w-6 h-6 group-hover:rotate-180 transition-transform duration-700"></i>
                <div class="flex flex-col">
                    <span class="font-display font-bold text-xl tracking-wider leading-none">SYNAPSE</span>
                    <span class="font-tech text-[10px] text-cyber-green tracking-[0.2em] leading-none">BRIEFING_SYSTEM</span>
                </div>
            </a>
            <div class="font-tech text-xs text-gray-500 hidden md:block">
                SESSION_ID: <span id="session-id" class="text-cyber-green">...</span>
            </div>
        </div>
    </header>

    <!-- Main Interface -->
    <main class="flex-grow flex items-center justify-center p-4 relative">
        <!-- Floating Deco -->
        <div class="absolute top-1/4 left-10 w-32 h-32 border border-cyber-green/20 rounded-full animate-spin-slow hidden lg:block"></div>

        <div class="w-full max-w-3xl bg-[#0a0a0a] border border-cyber-green/30 rounded-lg relative overflow-hidden shadow-[0_0_50px_rgba(0,0,0,0.8)]">
            
            <!-- Terminal Header -->
            <div class="bg-[#111] px-4 py-2 border-b border-white/10 flex items-center justify-between">
                <div class="flex gap-2">
                    <div class="w-3 h-3 rounded-full bg-red-500/50"></div>
                    <div class="w-3 h-3 rounded-full bg-yellow-500/50"></div>
                    <div class="w-3 h-3 rounded-full bg-green-500/50"></div>
                </div>
                <div class="font-tech text-xs text-gray-500">user@synapse:~/brief-config</div>
            </div>

            <!-- Progress Section -->
            <div class="px-8 pt-8 pb-4">
                <div class="flex justify-between items-end mb-2 font-tech text-xs">
                    <span class="text-cyber-green animate-pulse">SYSTEM CONFIGURATION</span>
                    <span id="progress-text" class="text-white">0%</span>
                </div>
                <div class="w-full h-1 bg-[#222] rounded-full overflow-hidden">
                    <div id="progress-bar" class="h-full bg-cyber-green progress-bar-fill w-0 relative"></div>
                </div>
            </div>

            <!-- Content Area -->
            <form id="briefForm" class="p-8 min-h-[400px] flex flex-col justify-between relative">
                
                <!-- Dynamic Questions Container -->
                <div id="question-container" class="space-y-8">
                    <!-- Questions will be injected here by JS -->
                </div>

                <!-- Navigation Controls -->
                <div class="flex justify-between items-center mt-12 pt-8 border-t border-white/5">
                    <button type="button" id="prevBtn" class="px-6 py-2 border border-white/20 text-gray-400 font-tech text-xs hover:text-white hover:border-white transition-all opacity-0 pointer-events-none flex items-center gap-2">
                        <i data-lucide="chevron-left" class="w-4 h-4"></i> –ù–ê–ó–ê–î
                    </button>
                    
                    <button type="button" id="nextBtn" class="px-8 py-3 bg-cyber-green text-black font-tech font-bold uppercase hover:bg-white transition-colors flex items-center gap-2 glow-box">
                        <span>–î–ê–õ–ï–ï</span> <i data-lucide="chevron-right" class="w-4 h-4"></i>
                    </button>

                    <button type="submit" id="submitBtn" class="hidden px-8 py-3 bg-cyber-green text-black font-tech font-bold uppercase hover:bg-white hover:shadow-[0_0_20px_#00ff9d] transition-all flex items-center gap-2">
                        <i data-lucide="send" class="w-4 h-4"></i> –û–¢–ü–†–ê–í–ò–¢–¨ –ü–†–û–¢–û–ö–û–õ
                    </button>
                </div>
            </form>

            <!-- Success Screen (Hidden) -->
            <div id="success-screen" class="hidden absolute inset-0 bg-black z-20 flex flex-col items-center justify-center text-center p-8">
                <i data-lucide="check-circle" class="w-20 h-20 text-cyber-green mb-6 animate-pulse"></i>
                <h2 class="font-display text-3xl text-white mb-2">–î–ê–ù–ù–´–ï –ü–†–ò–ù–Ø–¢–´</h2>
                <p class="font-tech text-gray-400 text-sm mb-8">–ë—Ä–∏—Ñ —Å—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω –∏ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω –≤ —Å—Ç—É–¥–∏—é.<br>–ú—ã —Å–≤—è–∂–µ–º—Å—è —Å –≤–∞–º–∏ –≤ —Ç–µ—á–µ–Ω–∏–µ 24 —á–∞—Å–æ–≤.</p>
                <a href="index-4.html" class="px-6 py-3 border border-cyber-green text-cyber-green font-tech text-xs hover:bg-cyber-green hover:text-black transition-all">
                    –í–ï–†–ù–£–¢–¨–°–Ø –ù–ê –ì–õ–ê–í–ù–£–Æ
                </a>
            </div>

            <!-- Error Screen (Hidden) -->
            <div id="error-screen" class="hidden absolute inset-0 bg-black z-20 flex flex-col items-center justify-center text-center p-8">
                <i data-lucide="alert-triangle" class="w-20 h-20 text-red-500 mb-6"></i>
                <h2 class="font-display text-3xl text-white mb-2">–û–®–ò–ë–ö–ê –û–¢–ü–†–ê–í–ö–ò</h2>
                <p class="font-tech text-gray-400 text-sm mb-8">–°–±–æ–π —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è —Å —Å–µ—Ä–≤–µ—Ä–æ–º. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â–µ —Ä–∞–∑.</p>
                <button onclick="location.reload()" class="px-6 py-3 border border-white text-white font-tech text-xs hover:bg-white hover:text-black transition-all">
                    –ü–ï–†–ï–ó–ê–ì–†–£–ó–ò–¢–¨
                </button>
            </div>

        </div>
    </main>

    <!-- JS Logic -->
    <script>
        lucide.createIcons();
        document.getElementById('session-id').innerText = '0x' + Math.floor(Math.random()*16777215).toString(16).toUpperCase();

        // --- –ö–û–ù–§–ò–ì–£–†–ê–¶–ò–Ø –í–û–ü–†–û–°–û–í ---
        const steps = [
            {
                id: 1,
                title: "01 // –ò–î–ï–ù–¢–ò–§–ò–ö–ê–¶–ò–Ø",
                questions: [
                    { id: "company", label: "–ù–∞–∑–≤–∞–Ω–∏–µ –∫–æ–º–ø–∞–Ω–∏–∏ / –ü—Ä–æ–µ–∫—Ç–∞", placeholder: "CyberDyne Systems", type: "text" },
                    { id: "current_site", label: "–¢–µ–∫—É—â–∏–π —Å–∞–π—Ç (–µ—Å–ª–∏ –µ—Å—Ç—å)", placeholder: "www.example.com", type: "text" }
                ]
            },
            {
                id: 2,
                title: "02 // –ü–ê–†–ê–ú–ï–¢–†–´ –°–ï–¢–ò",
                questions: [
                    { id: "domain", label: "–ñ–µ–ª–∞–µ–º—ã–π –¥–æ–º–µ–Ω", placeholder: "new-project.com", type: "text" },
                    // –ò–ó–ú–ï–ù–ï–ù–ò–ï: –í–æ–ø—Ä–æ—Å –ø—Ä–æ –ª–æ–≥–æ—Ç–∏–ø –≤–º–µ—Å—Ç–æ —Ç–∏–ø–∞ —Å–∞–π—Ç–∞
                    { 
                        id: "has_logo", 
                        label: "–ï—Å—Ç—å –ª–∏ –õ–æ–≥–æ—Ç–∏–ø?", 
                        type: "select", 
                        options: ["–î–∞, –µ—Å—Ç—å –∏—Å—Ö–æ–¥–Ω–∏–∫–∏", "–ï—Å—Ç—å, –Ω–æ —Å—Ç–∞—Ä—ã–π (–Ω—É–∂–µ–Ω —Ä–µ–¥–∏–∑–∞–π–Ω)", "–ù–µ—Ç, –Ω—É–∂–Ω–æ —Ä–∞–∑—Ä–∞–±–æ—Ç–∞—Ç—å", "–ù–µ—Ç, –ø–æ–∫–∞ –Ω–µ –Ω—É–∂–µ–Ω"] 
                    }
                ]
            },
            // –ò–ó–ú–ï–ù–ï–ù–ò–ï: –®–∞–≥ 3 —É–¥–∞–ª–µ–Ω, –Ω—É–º–µ—Ä–∞—Ü–∏—è —Å–¥–≤–∏–Ω—É—Ç–∞
            {
                id: 3,
                title: "03 // –¶–ï–õ–ò –ú–ò–°–°–ò–ò",
                questions: [
                    { id: "main_goal", label: "–û—Å–Ω–æ–≤–Ω–∞—è —Ü–µ–ª—å —Å–∞–π—Ç–∞", placeholder: "–ü—Ä–æ–¥–∞–∂–∞ —Ç–æ–≤–∞—Ä–∞, –°–±–æ—Ä –ª–∏–¥–æ–≤, –ò–º–∏–¥–∂", type: "text" },
                    { id: "target_action", label: "–¶–µ–ª–µ–≤–æ–µ –¥–µ–π—Å—Ç–≤–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è", placeholder: "–ö–ª–∏–∫–Ω—É—Ç—å '–ö—É–ø–∏—Ç—å', –û—Å—Ç–∞–≤–∏—Ç—å –∑–∞—è–≤–∫—É", type: "text" }
                ]
            },
            {
                id: 4,
                title: "04 // –ü–†–û–î–£–ö–¢",
                questions: [
                    { id: "usp", label: "–í–∞—à–µ –£–¢–ü (–£–Ω–∏–∫–∞–ª—å–Ω–æ–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ)", placeholder: "–ß–µ–º –≤—ã –ª—É—á—à–µ –¥—Ä—É–≥–∏—Ö? –í —á–µ–º —Å—É—Ç—å –ø—Ä–æ–¥—É–∫—Ç–∞?", type: "textarea" },
                    { id: "advantages", label: "3-5 –≥–ª–∞–≤–Ω—ã—Ö –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤", placeholder: "1. –°–∫–æ—Ä–æ—Å—Ç—å\n2. –ö–∞—á–µ—Å—Ç–≤–æ\n3. –¶–µ–Ω–∞", type: "textarea" }
                ]
            },
            {
                id: 5,
                title: "05 // –ê–ù–ê–õ–ò–ó –ê–£–î–ò–¢–û–†–ò–ò",
                questions: [
                    { id: "target_audience", label: "–ö—Ç–æ –∏–¥–µ–∞–ª—å–Ω—ã–π –∫–ª–∏–µ–Ω—Ç?", placeholder: "–ü–æ–ª, –≤–æ–∑—Ä–∞—Å—Ç, –±–æ–ª–∏, –∏–Ω—Ç–µ—Ä–µ—Å—ã", type: "textarea" },
                    { id: "first_impression", label: "–ü–µ—Ä–≤–æ–µ –≤–ø–µ—á–∞—Ç–ª–µ–Ω–∏–µ –æ—Ç —Å–∞–π—Ç–∞", placeholder: "–î–æ–≤–µ—Ä–∏–µ, –í–æ—Å—Ç–æ—Ä–≥, –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—á–Ω–æ—Å—Ç—å, –£—é—Ç", type: "text" }
                ]
            },
            {
                id: 6,
                title: "06 // –†–ê–ó–í–ï–î–ö–ê",
                questions: [
                    { id: "competitors", label: "–°—Å—ã–ª–∫–∏ –Ω–∞ –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–æ–≤", placeholder: "site1.ru, site2.com", type: "textarea" },
                    { id: "competitor_feedback", label: "–ß—Ç–æ —É –Ω–∏—Ö –Ω—Ä–∞–≤–∏—Ç—Å—è / –Ω–µ –Ω—Ä–∞–≤–∏—Ç—Å—è?", placeholder: "–ù—Ä–∞–≤–∏—Ç—Å—è –¥–∏–∑–∞–π–Ω, –±–µ—Å–∏—Ç —Å–ª–æ–∂–Ω–∞—è —Ñ–æ—Ä–º–∞...", type: "textarea" }
                ]
            },
            {
                id: 7,
                title: "07 // –í–ò–ó–£–ê–õ & –°–¢–†–£–ö–¢–£–†–ê",
                questions: [
                    { id: "structure", label: "–ü—Ä–∏–º–µ—Ä–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ (—Ä–∞–∑–¥–µ–ª—ã)", placeholder: "–ì–ª–∞–≤–Ω–∞—è, –û –Ω–∞—Å, –£—Å–ª—É–≥–∏, –ö–æ–Ω—Ç–∞–∫—Ç—ã", type: "textarea" },
                    { id: "design_style", label: "–ü–æ–∂–µ–ª–∞–Ω–∏—è –ø–æ —Å—Ç–∏–ª—é / –†–µ—Ñ–µ—Ä–µ–Ω—Å—ã", placeholder: "–ù—Ä–∞–≤–∏—Ç—Å—è –º–∏–Ω–∏–º–∞–ª–∏–∑–º, —Ç–µ–º–Ω–∞—è —Ç–µ–º–∞. –°—Å—ã–ª–∫–∏ –Ω–∞ –ø—Ä–∏–º–µ—Ä—ã...", type: "textarea" }
                ]
            },
            {
                id: 8,
                title: "08 // –ö–û–ù–¢–ê–ö–¢–´ –î–õ–Ø –°–í–Ø–ó–ò",
                questions: [
                    { id: "contact_name", label: "–í–∞—à–µ –ò–º—è", placeholder: "–ê–ª–µ–∫—Å–µ–π", type: "text" },
                    { id: "contact_method", label: "–¢–µ–ª–µ—Ñ–æ–Ω –∏–ª–∏ Telegram", placeholder: "+7 999 000 00 00 / @username", type: "text" }
                ]
            }
        ];

        let currentStep = 0;
        const formData = {};

        const questionContainer = document.getElementById('question-container');
        const prevBtn = document.getElementById('prevBtn');
        const nextBtn = document.getElementById('nextBtn');
        const submitBtn = document.getElementById('submitBtn');
        const progressBar = document.getElementById('progress-bar');
        const progressText = document.getElementById('progress-text');

        function renderStep(index) {
            const step = steps[index];
            const isLastStep = index === steps.length - 1;

            const progress = Math.round(((index) / steps.length) * 100);
            progressBar.style.width = `${progress}%`;
            progressText.innerText = `${progress}%`;

            questionContainer.innerHTML = '';
            
            const titleEl = document.createElement('h3');
            titleEl.className = "font-display text-2xl text-white mb-6 animate-pulse";
            titleEl.innerText = step.title;
            questionContainer.appendChild(titleEl);

            step.questions.forEach(q => {
                const wrapper = document.createElement('div');
                wrapper.className = "group relative mb-6 step-enter";
                
                const label = document.createElement('label');
                label.className = "block font-tech text-xs text-cyber-green mb-2 uppercase tracking-wider";
                label.innerText = `> ${q.label}`;
                
                let input;
                const savedValue = formData[q.id] || '';

                if (q.type === 'select') {
                    input = document.createElement('select');
                    input.className = "w-full bg-[#111] text-gray-300 p-3 border border-gray-700 focus:outline-none input-cyber font-sans text-sm rounded transition-all";
                    q.options.forEach(opt => {
                        const option = document.createElement('option');
                        option.value = opt;
                        option.innerText = opt;
                        if(opt === savedValue) option.selected = true;
                        input.appendChild(option);
                    });
                } else if (q.type === 'textarea') {
                    input = document.createElement('textarea');
                    input.className = "w-full bg-[#111] text-gray-300 p-3 border border-gray-700 focus:outline-none input-cyber font-sans text-sm rounded h-24 resize-none transition-all";
                    input.placeholder = q.placeholder;
                    input.value = savedValue;
                } else {
                    input = document.createElement('input');
                    input.type = "text";
                    input.className = "w-full bg-[#111] text-white p-3 border border-gray-700 focus:outline-none input-cyber font-sans text-sm rounded transition-all";
                    input.placeholder = q.placeholder;
                    input.value = savedValue;
                }

                input.dataset.id = q.id;
                input.dataset.label = q.label; // Store label for report
                input.addEventListener('input', (e) => {
                    formData[q.id] = e.target.value;
                });

                wrapper.appendChild(label);
                wrapper.appendChild(input);
                questionContainer.appendChild(wrapper);
            });

            // Buttons State
            if (index === 0) {
                prevBtn.style.opacity = '0';
                prevBtn.style.pointerEvents = 'none';
            } else {
                prevBtn.style.opacity = '1';
                prevBtn.style.pointerEvents = 'auto';
            }

            if (isLastStep) {
                nextBtn.classList.add('hidden');
                submitBtn.classList.remove('hidden');
            } else {
                nextBtn.classList.remove('hidden');
                submitBtn.classList.add('hidden');
            }
        }

        renderStep(currentStep);

        nextBtn.addEventListener('click', () => {
            const inputs = questionContainer.querySelectorAll('input, select, textarea');
            inputs.forEach(inp => formData[inp.dataset.id] = inp.value);

            if (currentStep < steps.length - 1) {
                currentStep++;
                renderStep(currentStep);
            }
        });

        prevBtn.addEventListener('click', () => {
            if (currentStep > 0) {
                currentStep--;
                renderStep(currentStep);
            }
        });

        // --- –õ–û–ì–ò–ö–ê –û–¢–ü–†–ê–í–ö–ò (FORMSPREE) ---
        document.getElementById('briefForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            
            // 1. –°–æ—Ö—Ä–∞–Ω—è–µ–º –ø–æ—Å–ª–µ–¥–Ω–∏–µ –¥–∞–Ω–Ω—ã–µ
            const inputs = questionContainer.querySelectorAll('input, select, textarea');
            inputs.forEach(inp => formData[inp.dataset.id] = inp.value);

            // 2. –í–∏–∑—É–∞–ª—å–Ω—ã–µ —ç—Ñ—Ñ–µ–∫—Ç—ã
            progressBar.style.width = '100%';
            progressText.innerText = '100%';
            submitBtn.innerHTML = `<i data-lucide="loader-2" class="w-4 h-4 animate-spin"></i> –û–¢–ü–†–ê–í–ö–ê...`;
            submitBtn.disabled = true;

            // 3. –§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–µ–ª–∞ –ø–∏—Å—å–º–∞ (–ö—Ä–∞—Å–∏–≤—ã–π —Ç–µ–∫—Å—Ç)
            let messageBody = "üöÄ –ù–û–í–´–ô –ë–†–ò–§ –û–¢ –ö–õ–ò–ï–ù–¢–ê\n\n";
            steps.forEach(step => {
                messageBody += `=== ${step.title} ===\n`;
                step.questions.forEach(q => {
                    messageBody += `${q.label}:\n${formData[q.id] || '-'}\n\n`;
                });
                messageBody += "-----------------------------------\n";
            });

            // 4. –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è Formspree
            // –ú—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º –ø–æ–ª—è email/contact_name –æ—Ç–¥–µ–ª—å–Ω–æ –¥–ª—è –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤ –ø–∏—Å—å–º–∞
            const payload = {
                name: formData['contact_name'] || '–ê–Ω–æ–Ω–∏–º',
                contact: formData['contact_method'] || '-',
                message: messageBody,
                _subject: `–ù–æ–≤—ã–π –±—Ä–∏—Ñ: ${formData['company'] || '–ë–µ–∑ –Ω–∞–∑–≤–∞–Ω–∏—è'}`
            };

            // 5. –û—Ç–ø—Ä–∞–≤–∫–∞ (–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤–∞—à ID —Ñ–æ—Ä–º—ã –∏–∑ index.html)
            try {
                const response = await fetch("https://formspree.io/f/mqaogzrv", {
                    method: "POST",
                    body: JSON.stringify(payload),
                    headers: {
                        'Accept': 'application/json',
                        'Content-Type': 'application/json'
                    }
                });

                if (response.ok) {
                    document.getElementById('success-screen').classList.remove('hidden');
                    lucide.createIcons();
                } else {
                    throw new Error('Network response was not ok');
                }
            } catch (error) {
                console.error("Error:", error);
                document.getElementById('error-screen').classList.remove('hidden');
                lucide.createIcons();
            }
        });

    </script>
</body>
</html>